/*! dashboard - v0.2.1 - 2015-10-29
* Copyright (c) 2015 ; Licensed  */
function listUpcomingEvents(){var a=new Date;a=a.setDate(a.getDate()+1);var b=gapi.client.calendar.events.list({calendarId:"primary",timeMin:(new Date).toISOString(),timeMax:new Date(a).toISOString(),showDeleted:!1,singleEvents:!0,orderBy:"startTime"});b.execute(function(a){var b=a.items,c=[];if(b.length>0)for(i=0;i<b.length;i++){var d=(new Date,new Date(b[i].start.dateTime)),e=new Date(b[i].end.dateTime),f=b[i].summary;if("Invalid Date"==d)c.push("All day | "+f);else{var g=zerofix(d.getHours())+":"+zerofix(d.getMinutes()),h=zerofix(e.getHours())+":"+zerofix(e.getMinutes());c.push(g+" - "+h+" "+f)}}else c.push("No upcoming events found.");fillList($("#calendar ul"),c)});var c=new Date,d=new Date;returnTime()>"15:00"&&(c.setDate(c.getDate()+1),d.setDate(d.getDate()+1)),c.setHours(8),c.setMinutes(0),d.setHours(18),d.setMinutes(0);var e=gapi.client.calendar.events.list({calendarId:"5h6fbbljm98089k740jlvtdg70@group.calendar.google.com",timeMin:c.toISOString(),timeMax:d.toISOString(),showDeleted:!1,singleEvents:!0,maxResults:9,orderBy:"startTime"});e.execute(function(a){var b=a.items,c=[];if(b.length>0)for(i=0;i<b.length;i++){var d=(new Date,new Date(b[i].start.dateTime)),e=new Date(b[i].end.dateTime),f=b[i].summary,g=zerofix(d.getHours())+":"+zerofix(d.getMinutes()),h=zerofix(e.getHours())+":"+zerofix(e.getMinutes());c.push("<span class='time'>"+g+" - "+h+"</span> "+f)}else c.push("No upcoming events found.");fillList($("#rooster ul"),c)})}function fillList(a,b){a.html("");for(var c=0;c<b.length;c++)a.append("<li>"+b[c]+"</li>")}function getSunsetSunrise(){$.get("http://api.sunrise-sunset.org/json?lat=52.379189&lng=4.899431&formatted=0",function(a){var b=new Date(a.results.sunrise),c=new Date(a.results.sunset);$("#sunrise span").html(zerofix(b.getHours())+":"+zerofix(b.getMinutes())),$("#sunset span").html(zerofix(c.getHours())+":"+zerofix(c.getMinutes()))})}function returnDayName(a){var b=a.getDay();return 0===b?"Sunday":1==b?"Monday":2==b?"Tuesday":3==b?"Wednesday":4==b?"Thursday":5==b?"Friday":6==b?"Saturday":void 0}function returnTime(){var a=new Date,b=a.getHours(),c=a.getMinutes();return zerofix(b)+":"+zerofix(c)}function returnDate(){var a=["January","February","March","April","May","June","July","August","September","October","November","December"],b=new Date,c=returnDayName(b),d=b.getDate(),e=a[b.getMonth()];return c+" "+d+" "+e}function zerofix(a){return 10>a?"0"+String(a):String(a)}function checkAuth(){gapi.auth.authorize({client_id:CLIENT_ID,scope:SCOPES,immediate:!0},handleAuthResult)}function handleAuthResult(a){var b=document.getElementById("authorize-div");a&&!a.error?(b.style.display="none",loadApis()):b.style.display="inline"}function handleAuthClick(a){return gapi.auth.authorize({client_id:CLIENT_ID,scope:SCOPES,immediate:!1},handleAuthResult),!1}function loadApis(){gapi.client.load("calendar","v3",listUpcomingEvents),gapi.client.load("gmail","v1",listMessages)}function getGreeting(){var a=returnTime();return a>="06:00"&&"12:00">a?"Goede morgen":a>="12:00"&&"18:00">a?"Goede middag":a>="18.00"&&"24:00">a?"Goede avond":a>="24.00"&&"06:00">a?"Goede nacht":"Goede dag"}function listMessages(){var a=[],b=function(b){for(var c=[],d=b.internalDate,e=b.snippet,f=b.payload.headers,g="",h=0;h<f.length;h++)"Subject"==f[h].name&&(g=f[h].value,c.push(d,g,e));if(a.push(c),5==a.length){$("#email ul").html("");for(var i=a.sort(function(a,b){return a[0]<b[0]}),j=0;j<i.length;j++)$("#email ul").append("<li><h2>"+i[j][1]+"</h2><span>"+i[j][2]+"</span></li>")}},c=function(a,c){a.execute(function(a){c=c.concat(a.messages);for(var d=0;d<c.length;d++){var e=c[d].id;getMessage(e,b)}})},d=gapi.client.gmail.users.messages.list({userId:"me",labelIds:"INBOX"});c(d,[])}function getMessage(a,b){var c=gapi.client.gmail.users.messages.get({userId:"me",id:a});c.execute(function(a){b(a)})}var CLIENT_ID="756478392094-cv1km3slb7h1hdejlnap2iplj55okutb.apps.googleusercontent.com",SCOPES=["https://www.googleapis.com/auth/calendar","https://www.googleapis.com/auth/gmail.readonly"];$(document).ready(function(){$("#clock h1").html(returnTime),$("#clock #date").html(returnDate),getSunsetSunrise(),$("#greeting").html(getGreeting()+", Renzo"),setInterval(function(){console.log("polling long interval..."),listMessages(),getSunsetSunrise(),$("#calendar ul").html(""),$("#rooster ul").html(""),listUpcomingEvents(),listMessages(),$("#greeting").html(getGreeting()+", Renzo")},3e5),setInterval(function(){console.log("polling short interval..."),$("#clock h1").html(returnTime),$("#clock #date").html(returnDate)},2e4)});